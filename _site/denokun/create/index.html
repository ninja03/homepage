<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title></title>
    <link rel="stylesheet" href="/denokun/style.css">
  </head>
  <body>
    <div class="header" onclick="location.href = '.'">
      
    </div>
      <p>最小構成のソースを作成する</p>
<ul>
<li>.vscode/setting.json（VSCodeの設定）</li>
<li>static/index.html（メインのHTML）</li>
<li>main.js（サーバソース）</li>
<li>run.bat（Windows用のサーバ起動バッチ）</li>
<li>run.sh（Linux用のサーバ起動スクリプト）</li>
<li>.vscode/launch.json（VSCodeでF5でサーバが起動する設定）</li>
</ul>
<hr>
<p>VSCodeの設定を作成する</p>
<ul>
<li>インデントを2文字</li>
<li>インデントをスペース</li>
<li>インデントの自動判定をオフ</li>
<li>Denoを有功化</li>
</ul>
<p><code>.vscode/setting.json</code></p>
<pre><code class="language-json">{
  &quot;editor.tabSize&quot;: 2,
  &quot;editor.insertSpaces&quot;: true,
  &quot;editor.detectIndentation&quot;: false,
  &quot;deno.enable&quot;: true
}
</code></pre>
<hr>
<p>サーバのソースを作成する</p>
<p><a href="https://fukuno.jig.jp/2943">Server.js</a>を使ってサーバを作成する</p>
<ul>
<li>HTMLと画像はstaticフォルダに配置する</li>
<li>サーバーにリクエストが来るとapi関数が呼ばれる
<ul>
<li>引数はパス(/api/xxx)とreq(JSONオブジェクト)</li>
<li>戻り値はJSON</li>
<li>returnしないと「not found」が返る</li>
</ul>
</li>
</ul>
<p><code>main.js</code></p>
<pre><code class="language-javascript">import { Server } from &quot;https://ninja03.github.io/denokun/lib/Server.js&quot;;

class MyServer extends Server {
  api(path, req) {

  }
}

new MyServer().start(8881);
</code></pre>
<hr>
<p>メインHTMLを作成する</p>
<p><code>static/index.html</code></p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;
    &lt;title&gt;WebApp&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    WebApp
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<hr>
<p>起動プログラム<code>run.bat</code>と<code>run.sh</code>を作成する</p>
<ul>
<li><code>-A</code>は通信とファイルアクセスに必要</li>
<li><code>--watch</code>はソースを編集すると自動でリロード</li>
<li><code>--unnstable</code>はServer.jsの動作に必要</li>
</ul>
<p><code>run.bat</code></p>
<pre><code class="language-bat">@echo off
deno run -A --watch --unstable main.js
</code></pre>
<p><code>run.sh</code></p>
<pre><code class="language-sh">run.sh
deno run -A --watch --unstable main.js
</code></pre>
<hr>
<p>VSCodeでF5キーでサーバが起動する設定を作成する</p>
<p><code>.vscode/launch.json</code></p>
<pre><code class="language-json">{
  &quot;version&quot;: &quot;0.2.0&quot;,
  &quot;configurations&quot;: [
    {
      &quot;name&quot;: &quot;Deno&quot;,
      &quot;type&quot;: &quot;pwa-node&quot;,
      &quot;request&quot;: &quot;launch&quot;,
      &quot;cwd&quot;: &quot;${workspaceFolder}&quot;,
      &quot;runtimeExecutable&quot;: &quot;deno&quot;,
      &quot;runtimeArgs&quot;: [&quot;run&quot;, &quot;-A&quot;, &quot;--watch&quot;, &quot;--unstable&quot;, &quot;main.js&quot;],
      &quot;outputCapture&quot;: &quot;std&quot;
    }
  ]
}
</code></pre>
<hr>
<p>動作確認をする</p>
<p>F5かrun.batで起動する<br>
ブラウザでhttp://localhost:8881を開く</p>

  </body>
</html>